define("text!scalejs.metadataFactory/metadataFactory.html",[],function(){return'<div id="metadata_items_template">\r\n    <!-- ko template: { name: \'metadata_item_template\', foreach: $data } -->\r\n\r\n    <!--/ko -->\r\n</div>\r\n\r\n<div id="metadata_item_template">\r\n    <!-- ko comment: $data.template || $data.type + \'_template\' -->\r\n    <!-- /ko -->\r\n    <!-- ko if: ($data.rendered == null) ? true : $data.rendered  -->\r\n    <!-- ko template: $data.template || $data.type + \'_template\' -->\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<div id="metadata_default_template">\r\n    <div data-bind="text: JSON.stringify($data)"></div>\r\n</div>\r\n\r\n<div id="metadata_loading_template">\r\n    <div class="loader hexdots-loader">\r\n    loading...\r\n    </div>\r\n</div>'}),define("text!scalejs.metadataFactory/action/views/action.html",[],function(){return'<div id="action_template">\r\n    <div data-bind="css: $data.classes, visible:isShown" class="action-button-wrapper">\r\n        <button data-class="action-button">\r\n            <span data-bind="text: text"></span>\r\n        </button>\r\n    </div>\r\n</div>\r\n'}),define("scalejs.metadataFactory/action/bindings/actionBindings.js",{"action-button":function(){var a=this.buttonClasses||"";return this.icon&&(a+=" fa fa-"+this.icon),{click:function(){this.action()},disable:this.disabled,css:a}}}),define("scalejs.metadataFactory/action/viewmodels/actionViewModel",["scalejs!core","knockout","text!scalejs.metadataFactory/action/views/action.html","scalejs.metadataFactory/action/bindings/actionBindings.js","scalejs.reactive","scalejs.mvvm"],function(a,b,c,d){"use strict";function e(a){g(i(a.target),a.params)}var f=a.object.merge,g=a.reactive.messageBus.notify,h=b.observable,i=b.unwrap,j=a.object.has;return a.mvvm.registerTemplates(c),a.mvvm.registerBindings(d),function(b){function c(){return q?void(l?g(l,{successCallback:q,options:m}):q(m,arguments)):void console.error("actions[actionType] is not defined",b)}var d=a.metadataFactory.getRegisteredActions(),i=b.text||b.options.text,k=a.metadataFactory.createViewModel.bind(this),l=b.validate,m=b.options||{},n=b.actionType,o={notify:e},p=a.object.extend(o,d),q=p[n]||null,r=h(!0),s=h(j(m.disabled)?m.disabled:!1),t=this;return q&&(q=q.bind(this)),"dropdown"===n&&(m.dropdown={showDropdown:h(!1),items:m.items.map(function(a){return k("string"==typeof a?{type:"action",text:a}:a)})}),f(b,{isShown:r,action:c,text:i,actionType:n,options:m,disabled:s,context:t})}}),define("scalejs.metadataFactory/action/actionModule",["scalejs!core","scalejs.metadataFactory/action/viewmodels/actionViewModel","scalejs.mvvm"],function(a,b){"use strict";function c(){return f}function d(b){a.object.extend(f,b)}var e=b,f={};return{action:e,registerActions:d,getRegisteredActions:c}}),define("scalejs.metadataFactory/template/templateViewModel",["scalejs!core","lodash","knockout"],function(a,b,c){"use strict";return function(d){var e,f,g=c.observable,h=a.object.merge,i=g(d.data||{}),j=d.options&&d.options.createContext?{metadata:[],data:i}:this,k=a.metadataFactory.createViewModel.bind(j),l=a.metadataFactory.createViewModels.bind(j),m=g(d.visible!==!1),n=b.cloneDeep(d.action);if(f=l(d.children||[]),e=n?k(n):function(){},d.dataSourceEndpoint){var o={callback:function(a,b){return a?void console.log("ajax request error",a):void i(b)}};k(d.dataSourceEndpoint).action(o)}return h(d,{mappedChildNodes:f,action:e,data:i,isShown:m,context:this})}}),define("scalejs.metadataFactory",["scalejs!core","knockout","lodash","text!scalejs.metadataFactory/metadataFactory.html","scalejs.metadataFactory/action/actionModule","scalejs.metadataFactory/template/templateViewModel","moment","scalejs.mvvm","scalejs.expression-jsep"],function(a,b,c,d,e,f,g){"use strict";function h(b){var d=v(!0),e=this;if(b=c.cloneDeep(b),!b||"ignore"!==b.type){var f=x[b.type]?x[b.type].call(this,b):k.call(this,b);return f&&r(b.rendered)&&(d=s(b.rendered,"boolean")?v(b.rendered):t(function(){return u(b.rendered,function(b){return e.getValue&&r(e.getValue(b))?e.getValue(b):"role"===b?a.userservice.role():""})})),f&&(f.type=f.type||b.type,f.rendered=d),f}console.log("ignored node ",b)}function i(d){var e;return e=this&&this.metadata?this:{metadata:d,getValue:function(d){return"store"===d&&a.noticeboard.global?b.unwrap(a.noticeboard.global.dictionary):"_"===d?c:"Date"==d?function(a){return g(a).toDate().getTime()}:"IncrementDate"==d?function(a,b,c){return g(a).add(b,c).toDate().getTime()}:z[d]}},d.map(function(a){return h.call(e,a)}).filter(function(a){return r(a)})}function j(b,c){if(!b)return a.mvvm.template("metadata_loading_template");Array.isArray(b)||(b=[b]);var d=c?i.call(c,b):i(b);return a.mvvm.template("metadata_items_template",d)}function k(b){return A?a.object.merge(b,{template:"metadata_default_template"}):void 0}function l(b){var c={};Object.keys(b).forEach(function(a){"type"!==a&&(Array.isArray(b[a])?c[a]=w(b[a]):c[a]=v(b[a]))}),a.object.extend(this,c)}function m(b){a.object.extend(x,b)}function n(b){a.object.extend(z,b)}function o(a){b.unwrap(a).forEach(function(a){a.dispose&&a.dispose(),o(a.mappedChildNodes||[])})}function p(a){for(var b in a)""!==b&&(y[b]=a[b])}function q(){var b,c={$schema:"http://json-schema.org/draft-04/schema#",definitions:{template:{type:"string"},type:{type:"string"},templateExt:{oneOf:[{not:{required:["template"]}}]},typeExt:{oneOf:[]},children:{type:"array",items:{$ref:"#/definitions/subObject"}},options:{type:"object"},classes:{type:"string"},subObject:{allOf:[{type:"object",properties:{template:{},type:{},children:{$ref:"#/definitions/children"},options:{$ref:"#/definitions/options"}},required:["type"]},{$ref:"#/definitions/typeExt"},{$ref:"#/definitions/templateExt"}]}},oneOf:[{$ref:"#/definitions/subObject"},{type:"array",items:{$ref:"#/definitions/subObject"}}]},d=[];for(var e in a.mvvm.getRegisteredTemplates())""!==e&&(y.hasOwnProperty(e)?(b={properties:{template:{"enum":[e]},options:{type:"object",properties:y[e]}},required:["template"]},c.definitions.templateExt.oneOf.push(b)):d.push(e));d.length>0&&(c.definitions.template["enum"]=d,b={properties:{template:{$ref:"#/definitions/template"}},required:["template"]},c.definitions.templateExt.oneOf.push(b));var f=[];for(var e in x)if(""!==e)if(y.hasOwnProperty(e+"_template")){var b={properties:{type:{"enum":[e]},options:{type:"object",properties:y[e+"_template"]}}};c.definitions.typeExt.oneOf.push(b)}else f.push(e);return f.length>0&&(c.definitions.type["enum"]=f,b={properties:{type:{$ref:"#/definitions/type"}}},c.definitions.typeExt.oneOf.push(b)),c}a.mvvm.registerTemplates(d);var r=a.object.has,s=a.type.is,t=b.computed,u=a.expression.evaluate,v=b.observable,w=b.observableArray,x={"":k,context:l,action:e.action,template:f},y={},z={},A=!0;b.bindingHandlers.metadataFactory={init:function(){return{controlsDescendantBindings:!0}},update:function(a,c,d,e,f){function g(){h=b.utils.domData.get(a,"metadata"),h&&(h=Array.isArray(h)?h:[h],o(h))}var h,i=b.unwrap(c()).metadata?b.unwrap(c()).metadata:b.unwrap(c()),k=b.unwrap(c()).context?b.unwrap(c()).context:null;setTimeout(function(){var c=j(i,k).template;g(),b.utils.domData.set(a,"metadata",c.data),b.bindingHandlers.template.update(a,function(){return c},d,e,f),h||b.utils.domNodeDisposal.addDisposeCallback(a,function(){g()})})}};var B={metadataFactory:{createTemplate:j,registerViewModels:m,createViewModels:i,createViewModel:h,useDefault:A,registerActions:e.registerActions,getRegisteredActions:e.getRegisteredActions,generateSchema:q,registerSchema:p,registerIdentifiers:n}};return a.registerExtension(B),B});